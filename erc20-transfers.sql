-- All subtokens deposits and withdrawals
SELECT
  UNIX_SECONDS(block_timestamp) as time,
  address as token,
  '0x' || SUBSTR(topics[OFFSET(1)], 27) as sender,
  '0x' || SUBSTR(topics[OFFSET(2)], 27) as receiver,
  data as amount
FROM `bigquery-public-data.crypto_ethereum.logs`
WHERE ARRAY_LENGTH(topics) > 0 AND topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' -- Transfer(address,address,uint256)
AND address IN (
    -- All Subtokens
    '0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48',
    '0x6b175474e89094c44da98b954eedeac495271d0f',
    '0x514910771af9ca656af840dff83e8264ecf986ca',
    '0x476c5e26a75bd202a9683ffd34359c0cc15be0ff',
    '0xdac17f958d2ee523a2206206994597c13d831ec7',
    '0x2260fac5e5542a773aa44fbcfedf7c193bc2c599',
    '0xd46ba6d942050d489dbd938a2c909a5d5039a161',
    '0xeb4c2781e4eba804ce9a9803c67d0893436bb27d',
    '0xfe18be6b3bd88a2d2a7f928d00292e7a9963cfc6',
    '0x80fb784b7ed66730e8b1dbd9820afd29931aab03',
    '0xc011a73ee8576fb46f5e1c5751ca3b9fe0af2a6f',
    '0x57ab1ec28d129707052df4df418d58a2d46d5f51',
    '0x0bc529c00c6401aef6d220be8c6ea1667f6ad93e',
    '0xd533a949740bb3306d119cc777fa900ba034cd52',
    '0x6810e776880c02933d47db1b9fc05908e5386b96',
    '0xa3bed4e1c75d00fa6f4e5e6922db7261b5e9acd2',
    '0x408e41876cccdc0f92210600ef50372656052a38',
    '0x9f8f72aa9304c8b593d555f12ef6589cc3a579a2',
    '0xdd974d5c2e2928dea5f71b9825b8b646686bd200',
    '0x5e74c9036fb86bd7ecdcb084a0673efc32ea31cb',
    '0xdf5e0e81dff6faf3a7e52ba697820c5e32d806a8',
    '0x8ab7404063ec4dbcfd4598215992dc3f8ec853d7',
    '0x0d438f3b5175bebc262bf23753c1e53d03432bde',
    '0x56d811088235f11c8920698a204a5010a788f4b3',
    '0x0000000000004946c0e9f43f4dee607b0ef1fa1c',
    '0x0ae055097c6d159879521c384f1d2123d1f195e6',
    '0xd71ecff9342a5ced620049e616c5035f1db98620',
    '0xb8baa0e4287890a5f79863ab62b7f175cecbd433',
    '0x1f9840a85d5af5bf1d1762f925bdaddc4201f984',
    '0xdf574c24545e5ffecb9a659c229253d4111d87e1',
    '0xdf574c24545e5ffecb9a659c229253d4111d87e1',
    '0x84ca8bc7997272c7cfb4d0cd3d55cd942b3c9419'
)
AND (
    topics[OFFSET(1)] IN (
         -- All LP Tokens
        '0x00000000000000000000000061bb2fda13600c497272a8dd029313afdb125fd3',
        '0x00000000000000000000000075116bd1ab4b0065b44e1a4ea9b4180a171406ed',
        '0x000000000000000000000000377d0c7ecf3f94968bcbf85de863282cae997b45',
        '0x00000000000000000000000033440a6139a550cd68ba21cdafa3241f10041d26',
        '0x000000000000000000000000beabef3fc02667d8bd3f702ae0bb2c4edb3640cc',
        '0x000000000000000000000000322a1e2e18fffc8d19948581897b2c49b3455240',
        '0x00000000000000000000000016ce81cfc20ce5ae4ab57a012e29ac067deed501',
        '0x0000000000000000000000004c84763c29ee86846f7b4e9cb8ea7884bbd405d5',
        '0x000000000000000000000000d1f905114005ec02585b0ba22a691344c6289d3e',
        '0x0000000000000000000000003863fc8c1cc59f160280f5d3e4c1a4c63f945ce3',
        '0x000000000000000000000000f95b6d2fb99f742e4bf0ec2cfe8f20c18cdd7c28',
        '0x000000000000000000000000296f09d5632487970664c62516d999d8eac8d8c8',
        '0x000000000000000000000000ed2c5bac5baedb7a59f8711659294ae3eef656e5',
        '0x00000000000000000000000003dfd032c9f7bff5517c9307da100e738dfad75b',
        '0x000000000000000000000000dfac4e58bdf6691562fc5fec6d9afc5d8111e076',
        '0x0000000000000000000000007f5d53d3bcc1b37a0c5fbd127d697f923e82cbb2',
        '0x00000000000000000000000043385366ed8775dd541f96df9950770e95ed060b',
        '0x0000000000000000000000003a5e247d1b931347ef6e75a11b28bc5bfb4f608e',
        '0x0000000000000000000000003062938bad00a2355dab2ce11462b615a49e736d',
        '0x0000000000000000000000006094bed8dd8ab2e58eed0933b34c60928080d4dc',
        '0x000000000000000000000000374fd7802c9d350e1a83042f2a8ee3fdb2f6260c',
        '0x0000000000000000000000008ed36239072eaac6d5f174718c16b07e36a2491d',
        '0x000000000000000000000000df42c6efc7ff03aa1c758ef7f678167f050a884e',
        '0x0000000000000000000000008c412a045dd7546f7f44fec5fcaf1f38ca10e66b',
        '0x000000000000000000000000727ec29ef1c78f93829d886474d8eb58c1450f80',
        '0x00000000000000000000000031631b3dd6c697e574d6b886708cd44f5ccf258f',
        '0x000000000000000000000000b91b439ff78531042f8eaaecaa5ecf3f88b0b67c',
        '0x0000000000000000000000002d5786b5cf47627f5c58e2026b80d7d56a296cea',
        '0x0000000000000000000000000e8f25fd45eee90733c46853bcc8b05494e10573',
        '0x000000000000000000000000e435cb6aca58dc49bda79753eed8c0fa6ed96e5d',
        '0x000000000000000000000000e5a6c0421388e4249f10da95c9094bde485a885b',
        '0x0000000000000000000000005b1fc2435b1f7c16c206e7968c0e8524ec29b786',
        '0x0000000000000000000000003426e78ecc79bf80910a808f1a90202972afda43',
        '0x00000000000000000000000075116bd1ab4b0065b44e1a4ea9b4180a171406ed',
        '0x000000000000000000000000eb94721976095d0b520d3c1028435fe6f5fa3acd',
        '0x000000000000000000000000b5ffd0a221fc94de9255382e70ce1aec76b68c89',
        '0x000000000000000000000000d4f0f8483ad1428477176a19df848c43f5ee9c44',
        '0x00000000000000000000000022c994e20f0944aa930f0fb0714c43a4e469ab62',
        '0x000000000000000000000000798934cdcfae18764ef4819274687df3fb24b99b',
        '0x0000000000000000000000003d0a8e6300a5a4094238003c3e875bda6c971f77',
        '0x00000000000000000000000018e9a09aed68f53f904a98b459420b1cee909d9e'
    ) OR topics[OFFSET(2)] IN (
        -- All LP Tokens
        '0x00000000000000000000000061bb2fda13600c497272a8dd029313afdb125fd3',
        '0x00000000000000000000000075116bd1ab4b0065b44e1a4ea9b4180a171406ed',
        '0x000000000000000000000000377d0c7ecf3f94968bcbf85de863282cae997b45',
        '0x00000000000000000000000033440a6139a550cd68ba21cdafa3241f10041d26',
        '0x000000000000000000000000beabef3fc02667d8bd3f702ae0bb2c4edb3640cc',
        '0x000000000000000000000000322a1e2e18fffc8d19948581897b2c49b3455240',
        '0x00000000000000000000000016ce81cfc20ce5ae4ab57a012e29ac067deed501',
        '0x0000000000000000000000004c84763c29ee86846f7b4e9cb8ea7884bbd405d5',
        '0x000000000000000000000000d1f905114005ec02585b0ba22a691344c6289d3e',
        '0x0000000000000000000000003863fc8c1cc59f160280f5d3e4c1a4c63f945ce3',
        '0x000000000000000000000000f95b6d2fb99f742e4bf0ec2cfe8f20c18cdd7c28',
        '0x000000000000000000000000296f09d5632487970664c62516d999d8eac8d8c8',
        '0x000000000000000000000000ed2c5bac5baedb7a59f8711659294ae3eef656e5',
        '0x00000000000000000000000003dfd032c9f7bff5517c9307da100e738dfad75b',
        '0x000000000000000000000000dfac4e58bdf6691562fc5fec6d9afc5d8111e076',
        '0x0000000000000000000000007f5d53d3bcc1b37a0c5fbd127d697f923e82cbb2',
        '0x00000000000000000000000043385366ed8775dd541f96df9950770e95ed060b',
        '0x0000000000000000000000003a5e247d1b931347ef6e75a11b28bc5bfb4f608e',
        '0x0000000000000000000000003062938bad00a2355dab2ce11462b615a49e736d',
        '0x0000000000000000000000006094bed8dd8ab2e58eed0933b34c60928080d4dc',
        '0x000000000000000000000000374fd7802c9d350e1a83042f2a8ee3fdb2f6260c',
        '0x0000000000000000000000008ed36239072eaac6d5f174718c16b07e36a2491d',
        '0x000000000000000000000000df42c6efc7ff03aa1c758ef7f678167f050a884e',
        '0x0000000000000000000000008c412a045dd7546f7f44fec5fcaf1f38ca10e66b',
        '0x000000000000000000000000727ec29ef1c78f93829d886474d8eb58c1450f80',
        '0x00000000000000000000000031631b3dd6c697e574d6b886708cd44f5ccf258f',
        '0x000000000000000000000000b91b439ff78531042f8eaaecaa5ecf3f88b0b67c',
        '0x0000000000000000000000002d5786b5cf47627f5c58e2026b80d7d56a296cea',
        '0x0000000000000000000000000e8f25fd45eee90733c46853bcc8b05494e10573',
        '0x000000000000000000000000e435cb6aca58dc49bda79753eed8c0fa6ed96e5d',
        '0x000000000000000000000000e5a6c0421388e4249f10da95c9094bde485a885b',
        '0x0000000000000000000000005b1fc2435b1f7c16c206e7968c0e8524ec29b786',
        '0x0000000000000000000000003426e78ecc79bf80910a808f1a90202972afda43',
        '0x00000000000000000000000075116bd1ab4b0065b44e1a4ea9b4180a171406ed',
        '0x000000000000000000000000eb94721976095d0b520d3c1028435fe6f5fa3acd',
        '0x000000000000000000000000b5ffd0a221fc94de9255382e70ce1aec76b68c89',
        '0x000000000000000000000000d4f0f8483ad1428477176a19df848c43f5ee9c44',
        '0x00000000000000000000000022c994e20f0944aa930f0fb0714c43a4e469ab62',
        '0x000000000000000000000000798934cdcfae18764ef4819274687df3fb24b99b',
        '0x0000000000000000000000003d0a8e6300a5a4094238003c3e875bda6c971f77',
        '0x00000000000000000000000018e9a09aed68f53f904a98b459420b1cee909d9e'
    )
)
ORDER BY block_timestamp, transaction_index, log_index
